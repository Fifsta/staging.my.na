files:     
    "/etc/php.d/newrelic.ini":
        mode: "000644"
        owner: ec2-user
        group: ec2-user
        content: |
            extension = "newrelic.so"
            [newrelic]
            newrelic.license = "83b97715b67250428f3a97761db0fc0b11d3ac68"
            newrelic.logfile = "/var/log/newrelic/php_agent.log"
            newrelic.appname = "BETA-MY-NA"
            newrelic.daemon.logfile = "/var/log/newrelic/newrelic-daemon.log"
    "/etc/php-7.2.d/custom_upload.ini":
        mode: "000644"
        owner: ec2-user
        group: ec2-user
        content: |
            upload_max_filesize = 32M
    "/etc/php-7.2.d/custom_sessions.ini":
        mode: "000644"
        owner: ec2-user
        group: ec2-user
        content: |
            session.save_handler = "redis"
            session.save_path = "myna-redis.hzh6ty.ng.0001.euw1.cache.amazonaws.com:6379"
            session.gc_maxlifetime = 2419200

    "/opt/elasticbeanstalk/hooks/appdeploy/post/99_asset_folders.sh":
        mode: "000777"
        owner: ec2-user
        group: ec2-user
        content: |
           #!/bin/bash
           mkdir -p /var/www/html/assets/users/photos/
           mkdir -p /var/www/html/assets/users/qr/
           mkdir -p /var/www/html/assets/images/
           mkdir -p /var/www/html/assets/qr/
           mkdir -p /var/www/html/assets/business/photos/
           mkdir -p /var/www/html/assets/business/products
           mkdir -p /var/www/html/assets/business/qr
           mkdir -p /var/www/html/assets/business/pdf
           mkdir -p /var/www/html/assets/business/gallery
           mkdir -p /var/www/html/assets/adverts/images
           mkdir -p /var/www/html/assets/products/images
           mkdir -p /var/www/html/assets/products/pdf
           mkdir -p /var/www/html/assets/content/audio
           mkdir -p /var/www/html/assets/content/photos
           mkdir -p /var/www/html/assets/deals/images
           mkdir -p /var/www/html/assets/documents
           mkdir -p /var/www/html/assets/experience
           mkdir -p /var/www/html/assets/vacancies/documents
           mkdir -p /var/www/html/assets/vacancies/dumps
           mkdir -p /var/www/html/assets/vacancies/images
           sudo chmod -R 777 /var/www/html/assets/

commands:
   create_post_dir:
     command: "mkdir /opt/elasticbeanstalk/hooks/appdeploy/post"
     ignoreErrors: true
   set_time_zone:
        command: ln -f -s /usr/share/zoneinfo/Africa/Windhoek /etc/localtime 
container_commands:
  01changePHP:
    command: sed -i '/PHP_DATE_TIMEZONE/ s/UTC/Africa\/Windhoek/' /etc/php.d/environment.ini
  01achangePHP:
    command: sed -i '/aws.php_date_timezone/ s/UTC/Africa\/Windhoek/' /etc/php.d/environment.ini
  02change_AWS_PHP:
    command: sed -i '/PHP_DATE_TIMEZONE/ s/UTC/Africa\/Windhoek/' /etc/httpd/conf.d/aws_env.conf
  03php_ini_set:
    command: sed -i '/date.timezone/ s/UTC/Africa\/Windhoek/' /etc/php.ini
  04composer_install:
    command: export COMPOSER_HOME=/root && /usr/bin/composer.phar self-update 1.0.0-alpha11
commands:
  01remove_local:
    command: "rm -rf /etc/localtime"
  02link_Buenos_Aires:
    command: "ln -s /usr/share/zoneinfo/Africa/Windhoek /etc/localtime"
  03restart_http:
    command: sudo service httpd restart        
packages:
    yum:
        newrelic-php5: []
        newrelic-sysmond: []
    rpm:
        newrelic: http://yum.newrelic.com/pub/newrelic/el5/x86_64/newrelic-repo-5-3.noarch.rpm
    commands:
        "01":
            command: newrelic-install install
            env:
                NR_INSTALL_SILENT: true
                NR_INSTALL_KEY: 83b97715b67250428f3a97761db0fc0b11d3ac68
        "02":
            command: echo newrelic.appname="BETA-MY-NA" >> /etc/php.ini
        "03":
            command: nrsysmond-config –set license_key=83b97715b67250428f3a97761db0fc0b11d3ac68
        "04":
            command: /etc/init.d/newrelic-sysmond start
        